language: java
jdk: [openjdk14]
git: {submodules: false}
cache:
  timeout: 900
  directories: [$HOME/.gradle/caches/, $HOME/.gradle/wrapper/]
before_cache: [rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock, rm -fr $HOME/.gradle/caches/*/plugin-resolution/]
env: [IDEA_VERSION=LATEST-EAP-SNAPSHOT, IDEA_VERSION=2020.3.2, IDEA_VERSION=2020.3]
before_install: [chmod +x gradlew, pip install --user codecov]
after_success: [codecov]
notifications:
  webhooks:
    urls: ['https://webhooks.gitter.im/e/33baacd26d1b840aebaa']
    on_success: always
    on_failure: always
    on_start: never
deploy:
  provider: releases
  api_key: ${GITHUB_KEY}
  skip_cleanup: true
  file_glob: true
  file: build/distributions/lombok-plugin-*.zip
  true: {tags: true, condition: '$TRAVIS_TAG =~ ^releasebuild_[0-9]+.*$'}
after_deploy: [./gradlew publishPlugin]
branches:
  only: [mplushnikov/lombok-intellij-plugin-1077-GRADLE_COMPILER_DAEMON]
